<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPS with ESP32</title>
</head>
<body>
    <a href="https://4karasoft.github.io/HTMLFiles/index.html">Main Page</a>
    <h1>GPS positioning with ESP32</h1>

    <p>
        <a href="https://www.espressif.com/en/products/hardware/esp32/overview">ESP32</a> is a board with built-in Wi-Fi, Bluetooth, MPU and many more. 
        Using Wi-Fi makes it very easy to send any type of data from the module to any other device.
        We will use <a href="https://www.arduino.cc/en/main/software">Arduino IDE</a> to configure the board to get the positioning data from GPS module to the computer.
        We are using <a href="https://www.u-blox.com/sites/default/files/products/documents/NEO-6_DataSheet_%28GPS.G6-HW-09005%29.pdf">GPS NEO-6M</a> module.
        
        To upload our code to the ESP32, we should configure the Arduino IDE first. 
        
        <ul>
            <li>If you have Mac or Linux use <a href="https://randomnerdtutorials.com/installing-the-esp32-board-in-arduino-ide-mac-and-linux-instructions/">this link</a>.</li>
            <li>If you have Windows use <a href="https://randomnerdtutorials.com/installing-the-esp32-board-in-arduino-ide-windows-instructions/">this link</a>.</li>
        </ul>

        After configuring the correct board, we can program it.
    </p>

<figure>
<figcaption>Your code title</figcaption>
<pre>
    <code>
#include "WiFi.h"
#define max_clients 3

int RxPin = 16;
int TxPin = 17;
int GPSBaud = 9600;

const char* ssid = "Save the Earth";
const char* password = "howtosaveit";

WiFiServer server(23);

WiFiClient serverClients[max_clients];

HardwareSerial gpsSerial(2);

void setup() {
    gpsSerial.begin(GPSBaud);
    Serial.begin(GPSBaud);
    WiFi.begin(ssid, password);
    Serial.print("\nConnecting to "); 
    Serial.println(ssid);
    int i = 0;

    while (WiFi.status() != WL_CONNECTED && i++ < 20) {
        delay(500);
    }

    if(i == 21) {
        Serial.print("Could not connect to"); Serial.println(ssid);
        while(true) delay(500);
    }

    Serial.begin(9600);
    server.begin();
    server.setNoDelay(true);
    Serial.print("IP of esp: ");
    Serial.print(WiFi.localIP());
    Serial.println(" 23 is port");
}    
void loop() {
    int i;
    if (server.hasClient()) {
        for(i = 0; i < max_clients; i++) {
            if (!serverClients[i] || !serverClients[i].connected()) {
                if(serverClients[i]) serverClients[i].stop();
                    serverClients[i] = server.available();
                    continue;
            }
        }

        WiFiClient serverClient = server.available();
        serverClient.stop();

    }

    for(i = 0; i < max_clients; i++) {
        if (serverClients[i] && serverClients[i].connected()) {
            if(serverClients[i].available()) {
                while(serverClients[i].available()) Serial.write(serverClients[i].read());
            }
        }
    }

    if(gpsSerial.available()) {
        size_t len = gpsSerial.available();
        uint8_t sbuf[len];
        gpsSerial.readBytes(sbuf, len);
        for(i = 0; i < max_clients; i++) {
            if (serverClients[i] && serverClients[i].connected()) {
                serverClients[i].write(sbuf, len);
            }
        }
    }
}
</code>
</pre>
</figure>
</body>
</html>